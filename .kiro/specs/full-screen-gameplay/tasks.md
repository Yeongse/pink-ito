# Implementation Plan

## Tasks

- [x] 1. プロジェクト基盤とテーマ設定
- [x] 1.1 (P) 依存パッケージの追加と設定
  - pubspec.yamlにprovider、flutter_animate、google_fontsを追加
  - flutter pub getで依存関係を解決
  - _Requirements: 8.5, 9.4_

- [x] 1.2 (P) アプリテーマとカラー定数の定義
  - ダークモードベースのカラーパレット（ネオンピンク、ダーク背景など）を定数化
  - Material Themeをカスタマイズしてアプリ全体に適用
  - タッチターゲットサイズの最小値を44×44pxに設定
  - _Requirements: 8.1, 8.4_

- [x] 1.3 (P) アニメーション定数の定義
  - 画面遷移、ボタンタップ、ネオンパルスなどの共通Duration値を定数化
  - イージングカーブの共通設定を定義
  - _Requirements: 8.2_

- [x] 2. ドメインモデルとデータ層
- [x] 2.1 (P) ドメインモデルの作成
  - Playerモデル（ID、名前、割り当て数字）を作成
  - Themeモデル（ID、タイトル）を作成
  - GameStateクラス（プレイヤーリスト、お題、数字、フェーズ）を作成
  - GamePhase列挙型で画面状態を定義
  - _Requirements: 9.2_

- [x] 2.2 (P) お題定数データの作成
  - 30個の下ネタ系お題を定数配列として定義
  - 各お題にユニークIDとタイトルを設定
  - _Requirements: 9.1, 9.2_

- [x] 2.3 お題リポジトリの実装
  - ランダムなお題選択機能を実装
  - 使用済みお題の除外ロジックを実装
  - 全お題使用時の自動リセット機能を実装
  - 残りお題数の取得機能を実装
  - _Requirements: 3.1, 3.3, 3.4, 9.3_

- [x] 3. 状態管理
- [x] 3.1 GameProviderの基本実装
  - ChangeNotifierを継承したGameProviderを作成
  - プレイヤー数設定と名前登録機能を実装
  - 全プレイヤー名入力完了の判定ロジックを実装
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5_

- [x] 3.2 ゲームフロー機能の実装
  - ゲーム開始時のお題選択とThemeRepository連携を実装
  - 1-100の重複なし数字生成ロジックを実装
  - プレイヤーインデックス管理と次プレイヤー遷移を実装
  - _Requirements: 3.1, 4.1, 4.6, 4.7_

- [x] 3.3 結果判定と再プレイ機能の実装
  - 並び替え結果の送信と保存機能を実装
  - 正解判定ロジック（数字の昇順確認）を実装
  - 「もう一度遊ぶ」機能（プレイヤー維持、お題リセット）を実装
  - 「最初から」機能（全状態リセット）を実装
  - _Requirements: 7.5, 7.6, 7.7, 7.8_

- [x] 4. 共通UIコンポーネント
- [x] 4.1 (P) ネオンテキストウィジェットの作成
  - 複数BoxShadowによるグロー効果を実装
  - グロー明滅アニメーション（2秒周期）を実装
  - フォントサイズとグローカラーのカスタマイズ対応
  - _Requirements: 8.1, 8.5_

- [x] 4.2 (P) ネオンボタンウィジェットの作成
  - ネオングロー効果付きのボタンスタイルを実装
  - タップ時のスケールアニメーション（1.0→0.95→1.0）を実装
  - パルスアニメーション（3秒周期）のオプションを実装
  - 有効/無効状態の視覚的切り替えを実装
  - _Requirements: 8.1, 8.3_

- [x] 4.3 (P) プレイヤーカードウィジェットの作成
  - プレイヤー名と順位表示の基本レイアウトを実装
  - 公開数字の表示機能を実装
  - 正解/不正解の視覚的フィードバック（グリーン/レッド、チェック/×）を実装
  - ドラッグ中の浮遊状態スタイル（シャドウ増加、スケール1.05）を実装
  - _Requirements: 2.3, 6.2, 6.3, 7.3, 7.4_

- [x] 4.4 (P) 画面遷移アニメーションの実装
  - フェード+スライド効果のカスタムPageRouteを作成
  - 遷移時間を300-400msに設定
  - _Requirements: 8.2_

- [x] 5. タイトル画面
- [x] 5.1 タイトル画面の実装
  - ネオンサイン風の「ピンク Ito」ロゴを中央に配置
  - サブタイトル「大人の数字当てゲーム」を控えめに表示
  - ロゴのネオングロー明滅アニメーション（2秒周期）を適用
  - パルスアニメーション付き「スタート」ボタンを配置
  - ボタンタップでプレイヤー設定画面への遷移を実装
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_

- [x] 6. プレイヤー設定画面
- [x] 6.1 プレイヤー設定画面の実装
  - 2-10人のプレイヤー数選択スライダーを実装
  - 選択人数に応じた名前入力フィールドの動的生成を実装
  - 入力完了行へのチェックマーク表示を実装
  - 全プレイヤー名入力完了時のボタン有効化を実装
  - 「ゲーム開始」ボタンタップでお題表示画面への遷移を実装
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [x] 7. お題表示画面
- [x] 7.1 お題表示画面の実装
  - ThemeRepositoryからランダムお題を取得して表示
  - タイプライター効果（50ms/文字）でお題を出現させる
  - ネオンフレーム装飾を適用
  - 「数字を配る」ボタンで数字配布画面への遷移を実装
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_

- [x] 8. 数字配布画面
- [x] 8.1 数字配布画面の実装
  - ハンドオフ画面（「{プレイヤー名}さんに渡してください」）を実装
  - タップで数字表示画面への内部遷移を実装
  - プレイヤー名と配布数字を超大型（120px以上）で中央表示
  - 数字へのネオングロー効果を適用
  - 「覚えたら次へ」ボタンで次プレイヤーのハンドオフへ遷移
  - 全プレイヤー配布完了後、表現タイム画面への遷移を実装
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7_

- [x] 9. 表現タイム画面
- [x] 9.1 表現タイム画面の実装
  - 「楽しく話し合ってね」メッセージを中央に大きく表示
  - 画面上部にお題リマインダーを小さく表示
  - パーティクルまたは光の粒の装飾アニメーションを実装
  - 「並び替えへ」ボタンで並び替え画面への遷移を実装
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [x] 10. 並び替え画面
- [x] 10.1 並び替え画面の実装
  - 「小さい順に並べてね」説明テキストを表示
  - ReorderableListViewでドラッグ可能なプレイヤーカードリストを実装
  - ロングプレスでドラッグモード開始、浮遊状態への視覚的変化を実装
  - ドラッグ中の他カード自動スペース確保とハイライト表示を実装
  - ドロップ時の滑らかなスロットインアニメーションを実装
  - 「答え合わせ」ボタンでリザルト画面への遷移を実装
  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6_

- [x] 11. リザルト画面
- [x] 11.1 リザルト画面の基本実装
  - 各プレイヤーの数字を1.5秒間隔で順次公開するアニメーションを実装
  - カードフリップまたはスライドアニメーションで数字を公開
  - 正解プレイヤーにグリーンハイライトとチェックマークを表示
  - 不正解プレイヤーにレッドハイライトと×マークを表示
  - _Requirements: 7.1, 7.2, 7.3, 7.4_

- [x] 11.2 結果演出と再プレイ機能の実装
  - 成功時に「SUCCESS!」テキストと紙吹雪アニメーションを表示
  - 失敗時に「残念...」テキストと正しい順番を表示
  - 「もう一度遊ぶ」ボタンでお題表示画面への遷移（プレイヤー維持）を実装
  - 「最初から」ボタンでタイトル画面への遷移を実装
  - _Requirements: 7.5, 7.6, 7.7, 7.8_

- [x] 12. アプリ統合とルーティング
- [x] 12.1 ルーティングとProvider設定
  - Named routesで全7画面を定義
  - ProviderでGameProviderをアプリ全体に提供
  - main.dartのエントリーポイントを更新してタイトル画面から開始
  - カスタム画面遷移アニメーションを全ルートに適用
  - _Requirements: 1.4, 2.6, 3.5, 4.7, 5.4, 6.6, 7.7, 7.8, 8.2_

- [x] 13. テストとバリデーション
- [x] 13.1 (P) ドメインモデルとリポジトリのユニットテスト
  - GameStateの状態遷移テストを作成
  - ThemeRepositoryのランダム選択と除外ロジックテストを作成
  - 数字生成の重複なし確認テストを作成
  - _Requirements: 4.1, 9.1, 9.3_

- [x] 13.2 (P) GameProviderのユニットテスト
  - プレイヤー管理機能のテストを作成
  - ゲームフロー状態遷移のテストを作成
  - 結果判定ロジックのテストを作成
  - _Requirements: 2.1, 2.5, 7.5, 7.6_

- [x]*  13.3 (P) ウィジェットテスト
  - NeonText/NeonButtonのレンダリングとアニメーションテストを作成
  - PlayerCardの各状態表示テストを作成
  - _Requirements: 8.1, 8.3_

- [x]*  13.4 統合テスト
  - タイトルからリザルトまでの完全なゲームフローテストを作成
  - 繰り返しプレイ時のお題重複回避テストを作成
  - _Requirements: 3.3, 7.7_
